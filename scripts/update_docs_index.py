#!/usr/bin/env python3
"""
Update Documentation Index
===========================

Updates the documentation index with latest reports and results.
"""

import os
import glob
from datetime import datetime

def update_docs_index():
    """Update the docs index with latest reports."""
    
    # Create docs directories if they don't exist
    os.makedirs('docs/results', exist_ok=True)
    os.makedirs('docs/weekly-reports', exist_ok=True)
    
    # Find latest reports
    weekly_reports = glob.glob('docs/results/weekly_report_*.html')
    phase4_reports = glob.glob('docs/results/phase4_comprehensive_*.html')
    weekly_phase4_reports = glob.glob('docs/results/weekly_phase4_enhanced_*.html')
    
    # Find the most recent reports
    latest_weekly = ""
    latest_phase4 = ""
    latest_weekly_phase4 = ""
    
    if weekly_reports:
        latest_weekly = max(weekly_reports, key=os.path.getctime)
        print(f"Latest weekly report: {latest_weekly}")
    
    if phase4_reports:
        latest_phase4 = max(phase4_reports, key=os.path.getctime)
        print(f"Latest Phase 4 enhanced report: {latest_phase4}")
    
    if weekly_phase4_reports:
        latest_weekly_phase4 = max(weekly_phase4_reports, key=os.path.getctime)
        print(f"Latest weekly Phase 4 report: {latest_weekly_phase4}")
    
    # Create or update index
    index_content = f"""# DataSON Benchmarks - Documentation Index

Last updated: {datetime.now().strftime('%Y-%m-%d %H:%M:%S')}

## 🚀 Latest Enhanced Reports

### 🎨 Phase 4 Enhanced Reports
Phase 4 reports include **comprehensive performance tables**, **smart unit formatting** (μs/ms/s), **interactive visualizations**, and **detailed analysis**.

- [🎨 Latest Enhanced Report](weekly-reports/latest_phase4_enhanced.html) - **Recommended viewing**
- [📊 All Phase 4 Reports](results/) - Browse all enhanced reports
- [🔍 Phase 4 Documentation](../PHASE_4_IMPLEMENTATION_COMPLETE.md) - Implementation details

### 📅 Weekly Reports
- [📈 Latest Weekly Report](weekly-reports/latest.html) - Standard weekly analysis
- [📊 Weekly Summaries](weekly-reports/latest.md) - Markdown summaries

### ⚡ Daily CI Reports  
- [🔄 Latest CI Results](results/) - Automated daily benchmark results
- [📊 Interactive Charts](results/) - Performance visualizations

## 🎯 What's New in Phase 4

✨ **Enhanced Features**:
- 📊 **Comprehensive Performance Tables** with real benchmark data
- 🎯 **Smart Unit Formatting** (microseconds → milliseconds → seconds)
- 🔍 **ML Framework Compatibility Matrix** (NumPy, Pandas support analysis)
- 🔒 **Security Features Analysis** (PII redaction, compliance features)
- 📈 **Interactive Charts** with Chart.js visualizations
- 💡 **Domain-Specific Recommendations** (Web API, ML, Finance, Data Engineering)

## 🔗 Navigation
- [🏠 Back to Main Repository](https://github.com/danielendler/datason-benchmarks)
- [📚 DataSON Library](https://github.com/danielendler/datason)
- [📖 DataSON Documentation](https://datason.readthedocs.io/en/latest/)
- [🔄 GitHub Actions](https://github.com/danielendler/datason-benchmarks/actions)

---
*Generated by update_docs_index.py | Enhanced with Phase 4 features*
"""
    
    with open('docs/index.md', 'w') as f:
        f.write(index_content)
    
    print("✅ Documentation index updated")

if __name__ == '__main__':
    update_docs_index() 