#!/usr/bin/env python3
"""
Update Documentation Index
===========================

Updates the documentation index with latest reports and results.
"""

import os
import glob
from datetime import datetime

def update_docs_index():
    """Update the docs index with latest reports."""
    
    # Create docs directories if they don't exist
    os.makedirs('docs/results', exist_ok=True)
    os.makedirs('docs/weekly-reports', exist_ok=True)
    
    # Find latest reports
    weekly_reports = glob.glob('docs/results/weekly_report_*.html')
    phase4_reports = glob.glob('docs/results/phase4_comprehensive_*.html')
    weekly_phase4_reports = glob.glob('docs/results/weekly_phase4_enhanced_*.html')
    
    # Find the most recent reports
    latest_weekly = ""
    latest_phase4 = ""
    latest_weekly_phase4 = ""
    
    if weekly_reports:
        latest_weekly = max(weekly_reports, key=os.path.getctime)
        print(f"Latest weekly report: {latest_weekly}")
    
    if phase4_reports:
        latest_phase4 = max(phase4_reports, key=os.path.getctime)
        print(f"Latest Phase 4 enhanced report: {latest_phase4}")
    
    if weekly_phase4_reports:
        latest_weekly_phase4 = max(weekly_phase4_reports, key=os.path.getctime)
        print(f"Latest weekly Phase 4 report: {latest_weekly_phase4}")
    
    # Create or update index
    index_content = f"""# DataSON Benchmarks - Documentation Index

Last updated: {datetime.now().strftime('%Y-%m-%d %H:%M:%S')}

## ğŸš€ Latest Enhanced Reports

### ğŸ¨ Phase 4 Enhanced Reports
Phase 4 reports include **comprehensive performance tables**, **smart unit formatting** (Î¼s/ms/s), **interactive visualizations**, and **detailed analysis**.

- [ğŸ¨ Latest Enhanced Report](weekly-reports/latest_phase4_enhanced.html) - **Recommended viewing**
- [ğŸ“Š All Phase 4 Reports](results/) - Browse all enhanced reports
- [ğŸ” Phase 4 Documentation](../PHASE_4_IMPLEMENTATION_COMPLETE.md) - Implementation details

### ğŸ“… Weekly Reports
- [ğŸ“ˆ Latest Weekly Report](weekly-reports/latest.html) - Standard weekly analysis
- [ğŸ“Š Weekly Summaries](weekly-reports/latest.md) - Markdown summaries

### âš¡ Daily CI Reports  
- [ğŸ”„ Latest CI Results](results/) - Automated daily benchmark results
- [ğŸ“Š Interactive Charts](results/) - Performance visualizations

## ğŸ¯ What's New in Phase 4

âœ¨ **Enhanced Features**:
- ğŸ“Š **Comprehensive Performance Tables** with real benchmark data
- ğŸ¯ **Smart Unit Formatting** (microseconds â†’ milliseconds â†’ seconds)
- ğŸ” **ML Framework Compatibility Matrix** (NumPy, Pandas support analysis)
- ğŸ”’ **Security Features Analysis** (PII redaction, compliance features)
- ğŸ“ˆ **Interactive Charts** with Chart.js visualizations
- ğŸ’¡ **Domain-Specific Recommendations** (Web API, ML, Finance, Data Engineering)

## ğŸ”— Navigation
- [ğŸ  Back to Main Repository](https://github.com/danielendler/datason-benchmarks)
- [ğŸ“š DataSON Library](https://github.com/danielendler/datason)
- [ğŸ“– DataSON Documentation](https://datason.readthedocs.io/en/latest/)
- [ğŸ”„ GitHub Actions](https://github.com/danielendler/datason-benchmarks/actions)

---
*Generated by update_docs_index.py | Enhanced with Phase 4 features*
"""
    
    with open('docs/index.md', 'w') as f:
        f.write(index_content)
    
    print("âœ… Documentation index updated")

if __name__ == '__main__':
    update_docs_index() 